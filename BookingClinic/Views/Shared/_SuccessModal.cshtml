@using BookingClinic.Application.Common
@using BookingClinic.Application.Interfaces.Helpers
@inject IViewMessageHelper messageHelper
@{
    var success = messageHelper.GetSuccess(TempData);
}

<div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content border-success">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title" id="successModalLabel">Success</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div>@success</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

@if (success != null)
{
    <script>
        (function () {
            function showSuccessModal() {
                var modalEl = document.getElementById('successModal');
                if (!modalEl) return;

                // Bootstrap 5 (native)
                if (window.bootstrap && typeof window.bootstrap.Modal === 'function') {
                    try {
                        var m = new bootstrap.Modal(modalEl);
                        m.show();
                        return;
                    } catch (e) {
                        console.error('Error showing bootstrap modal (BS5):', e);
                    }
                }

                // Fallback for Bootstrap 4 (jQuery)
                if (window.jQuery && typeof jQuery === 'function' && typeof jQuery(modalEl).modal === 'function') {
                    try {
                        jQuery(modalEl).modal('show');
                        return;
                    } catch (e) {
                        console.error('Error showing bootstrap modal (BS4/jQuery):', e);
                    }
                }

                console.warn('Success modal: Bootstrap JS not found or unsupported version.');
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', showSuccessModal);
            } else {
                showSuccessModal();
            }
        })();
    </script>
}